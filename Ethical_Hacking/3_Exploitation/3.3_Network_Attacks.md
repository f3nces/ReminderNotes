# Network Attacks

[TOC]

### MAC Flooding

+ **CAM** (Content Addressable Memory) table in switch could be **overflowed**
+ Switch no longer knows which port in the vlan to send traffic to when a frame is sent to a certain mac address, and so he **floods the traffic out of all ports in that vlan**
+ Tools:
  + **macof (dsniff suite)**
  + **yersinia**



### ARP Poisoning

+ **Gratuitous ARP Replies** - unsolicited ARP reply messages

+ **ARP Spoofing** - attacker tries to impersonate another host on the network (Allows MITM)
+ Tools:
  + **arpspoof**
  
  ```bash
  #Enable Linux Kernel IP Forwading (transform Linux into a router)
  echo 1 > /proc/sys/net/ipv4/ip_forward
  
  #Example Command
  #@interface - NIC to use (eth0 or tap0)
  arpspoof -i <interface> -t <target_ip> -r <impersonate_ip>
  ```
  + **Ettercap**



### Eavesdropping on encrypted traffic

+ **Mitmproxy** is a tool that serves fake certificates to the target
+ **SSLstrip** tool watches for https:// links or redirects in the network traffic and modifies them to http://
+ **SSLsplit** is another tool that works like mitmproxy



### DHCP Attacks

+ **Rogue DHCP servers**

  + Send DHCP reply faster than real DHCP server

  + Client configures itself with the options you send

  + Can also be used to position yourself as a man-inthe-middle

+ **DHCP starvation (DoS)**

  + Send lots of DHCPDISCOVER messages, exhausting the DHCP IP pool 

+ Tools:
  + **dhcpx**
  + **yersinia**


### Local Name resolution
+ DNS server and hosts file are not the only means of name resolution:
  + mDNS
  + LLMNR
  + Netbios
  + SSDP
+ All of these also rely on broadcast/multicast within the same vlan and are **not authenticated**, so any attacker in the vlan can spoof responses
+ Tools:
  + **responder**

### IPv6 Attacks
+ Router Discovery/Advertisement - Attacker can send fake router advertisements to announce themselves as a router
+ Neighbour Discovery
+ Duplicate Address Detection - Attacker can respond with positive
messages to all checks
+ Tools:
  + **THC6** 