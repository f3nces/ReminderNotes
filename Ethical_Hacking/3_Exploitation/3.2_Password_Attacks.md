# Password Attacks

[TOC]

## Password Guessing

### Hydra

+ Fast and parallelized cracker that supports different protocols

```bash
#Attack against SSH
hydra -l <username> -P <passwordlist> -w 10 -t 4 -V <target> ssh

#Attack against HTTP Basic Authentication
hydra -l <username> -P <passwordlist> -V <target> http-get

hydra -l <username> -P <passwordlist> <target> http-post-form "/<login url>:<username_field_name>=^USER^&<password_field_name>=^PASS^:<string_that_appears_when_invalid_login" -V

#Attack against FTP
hydra -l <username> -P <passwordlist> -V <target> ftp
```

| Flags             | Description                                                  |
| ----------------- | ------------------------------------------------------------ |
| **-l** <username> | Username                                                     |
| **-P** <filename> | Get the passwords from file                                  |
| **-t** <number>   | Number of parallel tasks, target could not handle the default setting of 16 simultaneous tasks! |
| **-w** <number>   | Max wait time between connects                               |
| **-V**            | Show login+password for every combination                    |
| **-f**            | Stops Hydra when finds a matching username and password      |



### Medusa

```bash
#First Option
medusa -h <host> -u <username> -p <password> -C <file> -M <module>

#Second Option
medusa -H <file> -U <file> -P <file> -C <file> -M <module>
```

| Flags                   | Description                                      |
| ----------------------- | ------------------------------------------------ |
| **-h** <target>         | Target hostname or IP address                    |
| **-H** <targets_file>   | File containing target hostnames or IP addresses |
| **-u** <username>       | Username to test                                 |
| **-U** <usernames_file> | File containing usernames to test                |
| **-p** <password>       | Password to test                                 |
| **-P** <usernames_file> | File containing passwords to test                |
| **-C** <file>           | File containing combo entries                    |
| **-M** <module_name>    | Name of the module to execute (optional)         |



### Ncrack





## Password Cracking

### Passwords on Linux

![](D:\SEGURANCA\01_Apontamentos\Ethical_Hacking\3_Exploitation\img\passwords_linux.png)



### Hash Identifiers

- https://github.com/noraj/haiti



### Hashcat

+ Verify Hash-mode (type) -  RL](https://hashcat.net/wiki/doku.php?id=example_hashes)
+ hashcat.potfile stores the passwords cracked

```bash
#Using hashcat
hashcat -m <hash-mode> <hash file> <wordlist>
```
| Flags                               | Description                                  |
| ----------------------------------- | -------------------------------------------- |
| **-m**                   | Hash type                |
| **-a**          | Attack mode |
| **-o**                         | Output file           |
| **-r** | Specify a file with rules |


### John The Ripper

```bash
### Incremental Mode: try all possible combinations (possible to define the min and max length in config file)
#1 - Put users and password on same file
unshadow /etc/passwd /etc/shadow > <file>

#2 - Brute Force passwords on the file
john --incremental --users=<user_list> <file>

### Wordlist Mode: Dictionary Attack
john --wordlist --users=<user_list> <file>

### Single Crack Mode: try passwords based on login information with mangling rules
john --single --format=<format> <file>

### Convert the gpg file into a hash string
gpg2john [encrypted gpg file] > [filename of the hash you want to create]
```

| Flags                               | Description                                  |
| ----------------------------------- | -------------------------------------------- |
| **--incremental**                   | Try all possible combinations                |
| **--wordlist** <=wordlist>          | Specify wordlist. If not use the default one |
| **--rules**                         | Enable dictionary mangling                   |
| **--users** <=user_list> or <=user> | Specify users                                |
| **--format=**<format>               | Specify which hash format                    |
| **--show**                          | Display passwords recovered                  |
| **--list=formats**                  | View the encryption formats used             |



### fcrackzip

```bash
#Brute force encrypted zip files
fcrackzip -b --method 2 -D <wordlist> -v <zip-file>
```

| Flag             | Description                        |
| ---------------- | ---------------------------------- |
| **-b**           | Specifies brute forcing            |
| **--method**     | Specifies a Zip file (number = 2)  |
| **-D**           | Specifies a Dictionary             |
| **-v**           | Verbose                            |
| **-l** <min-max> | Check password length (min to max) |



### Online Password Cracking

- https://crackstation.net/ 
- https://md5decrypt.net/en/ 
- https://hashes.com/en/decrypt/hash 





## Rainbow Tables Cracking

### ophcrack (Only to crack Windows passwords)

+ https://ophcrack.sourceforge.io/